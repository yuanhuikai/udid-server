<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>iOS UDID è·å–å·¥å…·</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
      body {
        font-family: sans-serif;
        background: #f5f5f5;
        margin: 0;
        padding: 0;
      }
      .container {
        max-width: 500px;
        margin: 60px auto;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 2px 8px #0001;
        padding: 2em;
      }
      h1 {
        color: #007aff;
        text-align: center;
      }
      h2 {
        color: #007aff;
        text-align: center;
      }
      .download-section {
        text-align: center;
      }
      .btn {
        background: #007aff;
        color: #fff;
        border: none;
        padding: 1em 2em;
        border-radius: 5px;
        font-size: 1.2em;
        cursor: pointer;
        text-decoration: none;
        display: inline-block;
        margin: 10px 0;
      }
      .btn:hover {
        background: #005bb5;
      }
      .copy-btn {
        background: #34c759;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 5px;
        cursor: pointer;
        margin-left: 10px;
        font-size: 0.9em;
      }
      .copy-btn:hover {
        background: #28a745;
      }
      .back-btn {
        background: #6c757d;
        color: white;
        text-decoration: none;
        padding: 8px 16px;
        border-radius: 5px;
        display: inline-block;
        margin-top: 1em;
        font-size: 0.9em;
      }
      .back-btn:hover {
        background: #5a6268;
      }
      .tip {
        color: #888;
        margin-top: 1em;
        font-size: 0.9em;
      }
      .result-section {
        display: none;
      }
      .info-box {
        background: #f8f9fa;
        padding: 1.5em;
        border-radius: 8px;
        margin: 1em 0;
      }
      .udid-text {
        font-family: monospace;
        font-size: 1.1em;
        color: #d6336c;
        background: #fff;
        padding: 10px;
        border-radius: 5px;
        border: 1px solid #ddd;
        word-break: break-all;
        margin: 10px 0;
      }
      .success {
        color: #28a745;
        font-size: 0.9em;
        margin-left: 10px;
        display: none;
      }
      .alert {
        background: #fff3cd;
        padding: 1em;
        border-radius: 5px;
        border-left: 4px solid #ffc107;
        margin: 1em 0;
      }
      .device-info p {
        margin: 0.5em 0;
        padding: 0.3em 0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- ä¸‹è½½åŒºåŸŸ -->
      <div id="downloadSection" class="download-section">
        <h1>iOS UDID è·å–å·¥å…·</h1>
        <p>è¯·ç”¨ <b>Safari</b> æµè§ˆå™¨æ‰“å¼€æœ¬é¡µé¢ï¼Œç‚¹å‡»ä¸‹æ–¹æŒ‰é’®è·å–æ‚¨çš„ UDIDã€‚</p>
        <a href="/get-udid" class="btn">è·å– UDID</a>
        <div class="tip">
          <p>1. ç‚¹å‡»æŒ‰é’®åï¼Œç³»ç»Ÿä¼šæç¤ºå®‰è£…æè¿°æ–‡ä»¶ï¼Œè¯·å…è®¸å®‰è£…ã€‚</p>
          <p>2. å®‰è£…å®Œæˆåä¼šè‡ªåŠ¨è·³è½¬å›ç½‘é¡µå¹¶æ˜¾ç¤ºæ‚¨çš„ UDIDã€‚</p>
          <p>3. æœ¬å·¥å…·ä¸ä¼šæ”¶é›†æ‚¨çš„ä»»ä½•ä¿¡æ¯ã€‚</p>
        </div>
      </div>

      <!-- ç»“æœåŒºåŸŸ -->
      <div id="resultSection" class="result-section">
        <h2>ğŸ‰ UDID è·å–æˆåŠŸï¼</h2>
        <div class="info-box">
          <p><strong>UDID:</strong></p>
          <div class="udid-text" id="udidValue"></div>
          <button class="copy-btn" onclick="copyUDID()">å¤åˆ¶UDID</button>
          <span class="success" id="copySuccess">å·²å¤åˆ¶!</span>

          <div class="device-info" style="margin-top: 1.5em">
            <p><strong>è®¾å¤‡ä¿¡æ¯:</strong></p>
            <p>ğŸ“± è®¾å¤‡å‹å·: <span id="productValue"></span></p>
            <p>ğŸ“‹ ç³»ç»Ÿç‰ˆæœ¬: <span id="versionValue"></span></p>
            <p>ğŸ• è·å–æ—¶é—´: <span id="timeValue"></span></p>
          </div>
        </div>

        <div class="alert">
          <p><strong>ğŸ’¡ æç¤º:</strong></p>
          <p>â€¢ è¯·å¦¥å–„ä¿å­˜æ‚¨çš„ UDID</p>
          <p>â€¢ å¯ä»¥åˆ é™¤åˆšæ‰å®‰è£…çš„æè¿°æ–‡ä»¶äº†</p>
          <p>â€¢ è®¾ç½® â†’ é€šç”¨ â†’ VPNä¸è®¾å¤‡ç®¡ç† â†’ åˆ é™¤æè¿°æ–‡ä»¶</p>
        </div>

        <a href="/" class="back-btn">é‡æ–°è·å–</a>
      </div>
    </div>

    <script>
      // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ URL å‚æ•°
      window.addEventListener("DOMContentLoaded", function () {
        const urlParams = new URLSearchParams(window.location.search);
        const udid = urlParams.get("udid");
        const product = urlParams.get("product");
        const version = urlParams.get("version");

        if (udid && udid !== "æœªè·å–åˆ°UDID") {
          // æ˜¾ç¤ºç»“æœåŒºåŸŸï¼Œéšè—ä¸‹è½½åŒºåŸŸ
          document.getElementById("downloadSection").style.display = "none";
          document.getElementById("resultSection").style.display = "block";

          // å¡«å……æ•°æ®
          document.getElementById("udidValue").textContent = udid;
          document.getElementById("productValue").textContent = product || "æœªçŸ¥è®¾å¤‡";
          document.getElementById("versionValue").textContent = version || "æœªçŸ¥ç‰ˆæœ¬";
          document.getElementById("timeValue").textContent = new Date().toLocaleString();
        }
      });

      // å¤åˆ¶ UDID åŠŸèƒ½
      function copyUDID() {
        const udidText = document.getElementById("udidValue").textContent;

        // ç°ä»£æµè§ˆå™¨æ–¹æ³•
        if (navigator.clipboard && window.isSecureContext) {
          navigator.clipboard
            .writeText(udidText)
            .then(function () {
              showCopySuccess();
            })
            .catch(function () {
              fallbackCopy(udidText);
            });
        } else {
          // é™çº§æ–¹æ¡ˆ
          fallbackCopy(udidText);
        }
      }

      // é™çº§å¤åˆ¶æ–¹æ¡ˆ
      function fallbackCopy(text) {
        const textArea = document.createElement("textarea");
        textArea.value = text;
        textArea.style.position = "fixed";
        textArea.style.opacity = "0";
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();

        try {
          document.execCommand("copy");
          showCopySuccess();
        } catch (err) {
          console.error("å¤åˆ¶å¤±è´¥:", err);
          alert("å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©æ–‡æœ¬å¤åˆ¶");
        }

        document.body.removeChild(textArea);
      }

      // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸæç¤º
      function showCopySuccess() {
        const success = document.getElementById("copySuccess");
        success.style.display = "inline";
        setTimeout(() => {
          success.style.display = "none";
        }, 2000);
      }
    </script>
  </body>
</html>
